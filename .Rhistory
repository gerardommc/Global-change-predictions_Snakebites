plot.title = element_text(hjust = 0.5))
per.ch.plot <- ggplot(per.change) + geom_bar(aes(x = scenario, y = env.change, colour = scenario), stat = "identity", alpha = 0.5) +
labs(x = "", y = "Average % change") +
theme(axis.text.x = element_text(vjust = 0.5, size = 6),
axis.text.y = element_text(size = 8),
axis.title.y = element_text(size = 10),
legend.position = "none")
multiplot(ch.plot, per.ch.plot, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2), ncol = 1))
pdf("Plots/Total-change.pdf", width = 9, height = 6)
multiplot(ch.plot, per.ch.plot, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2, 2), ncol = 1))
dev.off()
knitr::opts_chunk$set(echo = TRUE)
library(raster); library(ggplot2);library(reshape); library(foreach); library(data.table)
incid.data <- readRDS("Data-objects/Incidence models data-Apr2020.rds")
proj.files <- list.files("Incidence-projections", "rds", full.names = T)
projections <- lapply(proj.files, readRDS)
scenarios <- substr(proj.files, 34, nchar(proj.files) - 4)
med.projs <- lapply(projections, function(x){
d <- foreach(i = seq_along(x), .combine = rbind) %do% {colMeans(x[[i]])}
d <- data.frame(d)
d$year <- 2010:2050
return(d)
})
med.projs <- lapply(seq_along(med.projs),
function(x){
med.projs[[x]]$scenario <- scenarios[x]
return(med.projs[[x]])
})
med.projs.df <- rbindlist(med.projs)
med.projs.df$scen <- med.projs.df$scenario
library(ggplot2)
env.time <-  ggplot(med.projs.df) +
geom_ribbon(aes(x = year, ymin = env.025, ymax = env.97, fill = scen), alpha = 0.05) +
geom_point(aes(x = year, y = env.med, colour = scen), size = 0.25) +
geom_line(aes(x = year, y = env.med, colour = scen), size = 0.25, linetype = "dotted") +
geom_hline(yintercept = mean(incid.data$envenomings), colour = "grey50", linetype = "dashed") +
geom_smooth(aes(x = year, y = env.med, colour = scen, fill = scen), alpha = 0.2, size = 0.75, method = "lm") +
labs(x = "Year", y = "Envenoming incidence", colour = "Scenario", fill = "Scenario") +
theme_light() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.7))
env.time
decline.model <- lm(env.med ~ 0 + scen + scen : year, data = med.projs.df)
sum.mod <- summary(decline.model)
rates <- data.frame(sum.mod$coefficients)
rates.df <- rates[8:14,]
rates.df$proj <- c("SSP1",
"SSP2 CNRM-CM5", "SSP2 GFDL-CM3", "SSP2 MPI-ESM-LR",
"SSP5 CNRM-CM5", "SSP5 GFDL-CM3", "SSP5 MPI-ESM-LR")
rates.df$signif <- as.factor(ifelse(rates.df$Pr...t.. > 0.05, 0, 1))
rates.df$SSP <- as.factor(substr(rates.df$proj, 1, 4))
rates.plot <- ggplot(rates.df) + geom_boxplot(aes(x = 1, y = Estimate)) +
geom_point(aes(x = 1, y = Estimate, colour = proj, shape = signif ), size = 3, position = position_dodge(0.3))+
scale_shape_manual(values = c(4, 20)) +
geom_linerange(aes(x = 1, ymin = Estimate - Std..Error, ymax = Estimate + Std..Error, colour = proj), position = position_dodge(0.3)) +
labs(colour = "Scenario", y = "Absolute incidence change per year",
x = "") +
theme(axis.text.x = element_text(size = 0),
legend.position = "none")
rates.plot
med.projs.df$year[1]
scen <- levels(as.factor(med.projs.df$scen))
new.data.2050 <- expand.grid(scen = scen, year = 2050)
new.data.2010 <- expand.grid(scen = scen, year = 2010)
preds.2050 <- predict(decline.model, newdata = new.data.2050)
preds.2010 <- predict(decline.model, newdata = new.data.2010)
Percent.decline <- (preds.2010-preds.2050)/mean(incid.data$envenomings) * 100
Percent.decline
rates.df$Percent.decline <- Percent.decline * (-1)
percent.plot <- ggplot(rates.df) + geom_bar(aes(x = proj, y = Percent.decline*(-1), colour = proj, fill = proj),
stat = "identity", alpha = 0.5)+
scale_shape_manual(values = c(4, 20)) +
labs(colour = "Scenario", y = "Percent change per year",
x = "") +
theme(axis.text.x = element_text(size = 0),
legend.position = "none")
percent.plot
source("Random-functions/multiplot.R")
multiplot(rates.plot, env.time, layout = matrix(c(1, 2, 2, 2, 2, 2), ncol = 6))
dir.create("Plots")
pdf("Plots/Evenoming-change.pdf", width = 12, height = 6)
multiplot(rates.plot, env.time, layout = matrix(c(1, 2, 2, 2, 2, 2), ncol = 6))
dev.off()
env.changes <- lapply(projections, function(x){lapply(x, function(x1){x1$env.med})})
env.changes <- lapply(env.changes, function(x){
foreach(i = seq_along(x), .combine = cbind) %do% {
x[[i]]
}
})
change.models <- lapply(env.changes, function(x){
foreach(i = 1:nrow(x), .combine = rbind) %do% {
df <- data.frame(env <- x[i, ], time = 1:41)
model <- lm(env ~ time, data = df)
r2 <- summary(model)$adj.r.squared
P <- summary(model)$coefficients[2, 4]
return(c(intercept = model$coefficients["(Intercept)"],
rate = model$coefficients["time"],
P = P, r2 = r2))
}
})
ch.mods <- foreach(i = 1:7, .combine = rbind) %do% {
rate <- change.models[[i]][, 2]
intercept<- change.models[[i]][, 1]
P <- change.models[[i]][, 2]
r2 <- change.models[[i]][, 3]
scen <- scenarios[i]
return(data.frame(x = incid.data$x,
y = incid.data$y,
intercept = intercept,
rate = rate,
P = P,
r2 = r2,
scenario = scen))
}
library(viridis)
total.changes <- ch.mods$rate/rep(incid.data$envenomings, 7)*100
tot.2010 <- ch.mods$intercept + ch.mods$rate
tot.2050 <- ch.mods$intercept + ch.mods$rate*41
ch.mods$env.2010 <- tot.2010
ch.mods$env.2050 <- tot.2050
ch.mods$env.change <- with(ch.mods, env.2050/env.2010-env.2010/env.2010)*100
library(dplyr)
per.change <- ch.mods %>% group_by(scenario) %>% summarise(env.change = mean(na.omit(env.change)), env.err = sd(na.omit(env.change)))
per.ch.plot.2 <- ggplot(ch.mods) + geom_boxplot(aes(x = scenario, y = env.change, colour = scenario), stat = "identity", alpha = 0.5) +
labs(x = "", y = "Average % change") +
theme(axis.text.x = element_text(vjust = 0.5, size = 6),
axis.text.y = element_text(size = 8),
axis.title.y = element_text(size = 10),
legend.position = "none")
per.ch.plot.2
ggplot(ch.mods) + geom_boxplot(aes(x = scenario, y = env.change, colour = scenario), stat = "identity", alpha = 0.5)
ggplot(ch.mods) + geom_boxplot(aes(y = env.change, colour = scenario), stat = "identity", alpha = 0.5)
names(ch.mods)
ggplot(ch.mods) + geom_boxplot(aes(y = env.change, fill = scenario), stat = "identity", alpha = 0.5)
ch.mods$env.change
ggplot(ch.mods) + geom_boxplot(aes(x = scenario, y = env.change, fill = scenario), alpha = 0.5)
ggplot(ch.mods) + geom_boxplot(aes(x = scenario, y = env.change, colour = scenario), alpha = 0.5)
per.ch.plot.2 <- ggplot(ch.mods) + geom_boxplot(aes(x = scenario, y = env.change, colour = scenario), alpha = 0.5) +
labs(x = "", y = "Average % change") +
theme(axis.text.x = element_text(vjust = 0.5, size = 6),
axis.text.y = element_text(size = 8),
axis.title.y = element_text(size = 10),
legend.position = "none")
per.ch.plot.2
multiplot(ch.plot, per.ch.plot.2, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2), ncol = 1))
jet.colours <- colorRampPalette(c("navyblue", "royalblue4", "deepskyblue3", "yellow2", "darkorange", "red3", "#7F0000"))
ch.plot <- ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = env.change)) +
facet_grid(1 ~ scenario) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = jet.colours(100),
breaks = c(-100, -50, 0, 50, 100),
limits = c(-105, 105)) +
labs(title = "Envenoming incidence change by 2050", x = "", y = "", fill = "%") +
theme_light()+
theme(legend.position = "right",
axis.text.x = element_blank(),
axis.text.y = element_text(size = 6),
axis.title.y =  element_blank(),
legend.text = element_text(vjust = 0.5, size = 8),
legend.title = element_text(size = 10),
strip.text.x = element_text(size = 7),
strip.text.y = element_blank(),
plot.title = element_text(hjust = 0.5))
per.ch.plot <- ggplot(per.change) + geom_bar(aes(x = scenario, y = env.change, colour = scenario), stat = "identity", alpha = 0.5) +
labs(x = "", y = "Average % change") +
theme(axis.text.x = element_text(vjust = 0.5, size = 6),
axis.text.y = element_text(size = 8),
axis.title.y = element_text(size = 10),
legend.position = "none")
per.ch.plot.2 <- ggplot(ch.mods) + geom_boxplot(aes(x = scenario, y = env.change, colour = scenario), alpha = 0.5) +
labs(x = "", y = "Average % change") +
theme(axis.text.x = element_text(vjust = 0.5, size = 6),
axis.text.y = element_text(size = 8),
axis.title.y = element_text(size = 10),
legend.position = "none")
multiplot(ch.plot, per.ch.plot, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2), ncol = 1))
multiplot(ch.plot, per.ch.plot.2, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2), ncol = 1))
per.ch.plot.2 <- ggplot(ch.mods) + geom_violin(aes(x = scenario, y = env.change, colour = scenario), alpha = 0.5) +
labs(x = "", y = "Average % change") +
theme(axis.text.x = element_text(vjust = 0.5, size = 6),
axis.text.y = element_text(size = 8),
axis.title.y = element_text(size = 10),
legend.position = "none")
multiplot(ch.plot, per.ch.plot.2, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2), ncol = 1))
labs(x = "", y = "Average % change") +
theme(axis.text.x = element_text(vjust = 0.5, size = 6),
axis.text.y = element_text(size = 8),
axis.title.y = element_text(size = 10),
legend.position = "none")
multiplot(ch.plot, per.ch.plot.2, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2), ncol = 1))
per.ch.plot.2 <- ggplot(ch.mods) + geom_violin(aes(x = scenario, y = env.change, colour = scenario), alpha = 0.5) +
geom_boxplot(aes(x = scenario, y = env.change, fill = scenario), alpha = 0.1) +
labs(x = "", y = "Average % change") +
theme(axis.text.x = element_text(vjust = 0.5, size = 6),
axis.text.y = element_text(size = 8),
axis.title.y = element_text(size = 10),
legend.position = "none")
multiplot(ch.plot, per.ch.plot.2, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2), ncol = 1))
per.ch.plot.2 <- ggplot(ch.mods) + geom_violin(aes(x = scenario, y = env.change, colour = scenario), alpha = 0.5) +
geom_boxplot(aes(x = scenario, y = env.change, fill = scenario, colour = scenario), alpha = 0.1) +
labs(x = "", y = "Average % change") +
theme(axis.text.x = element_text(vjust = 0.5, size = 6),
axis.text.y = element_text(size = 8),
axis.title.y = element_text(size = 10),
legend.position = "none")
multiplot(ch.plot, per.ch.plot.2, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2), ncol = 1))
jet.colours <- colorRampPalette(c("navyblue", "royalblue4", "deepskyblue3", "yellow2", "darkorange", "red3", "#7F0000"))
ch.plot <- ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = env.change)) +
facet_grid(1 ~ scenario) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = jet.colours(100),
breaks = c(-100, -50, 0, 50, 100),
limits = c(-105, 105)) +
labs(title = "Envenoming incidence change by 2050", x = "", y = "", fill = "%") +
theme_light()+
theme(legend.position = "right",
axis.text.x = element_blank(),
axis.text.y = element_text(size = 6),
axis.title.y =  element_blank(),
legend.text = element_text(vjust = 0.5, size = 8),
legend.title = element_text(size = 10),
strip.text.x = element_text(size = 7),
strip.text.y = element_blank(),
plot.title = element_text(hjust = 0.5))
per.ch.plot <- ggplot(per.change) + geom_bar(aes(x = scenario, y = env.change, colour = scenario), stat = "identity", alpha = 0.5) +
labs(x = "", y = "Average % change") +
theme(axis.text.x = element_text(vjust = 0.5, size = 6),
axis.text.y = element_text(size = 8),
axis.title.y = element_text(size = 10),
legend.position = "none")
per.ch.plot.2 <- ggplot(ch.mods) + geom_violin(aes(x = scenario, y = env.change, colour = scenario), alpha = 0.5) +
geom_boxplot(aes(x = scenario, y = env.change, fill = scenario, colour = scenario), alpha = 0.1) +
labs(x = "", y = "Average % change") +
theme(axis.text.x = element_text(vjust = 0.5, size = 6),
axis.text.y = element_text(size = 8),
axis.title.y = element_text(size = 10),
legend.position = "none")
multiplot(ch.plot, per.ch.plot, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2, 2), ncol = 1))
multiplot(ch.plot, per.ch.plot.2, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2, 2), ncol = 1))
jet.colours <- colorRampPalette(c("navyblue", "royalblue4", "deepskyblue3", "yellow2", "darkorange", "red3", "#7F0000"))
ch.plot <- ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = env.change)) +
facet_grid(1 ~ scenario) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = jet.colours(100),
breaks = c(-100, -50, 0, 50, 100),
limits = c(-105, 105)) +
labs(title = "Envenoming incidence change by 2050", x = "", y = "", fill = "%") +
theme_light()+
theme(legend.position = "right",
axis.text.x = element_blank(),
axis.text.y = element_text(size = 6),
axis.title.y =  element_blank(),
legend.text = element_text(vjust = 0.5, size = 8),
legend.title = element_text(size = 10),
strip.text.x = element_text(size = 7),
strip.text.y = element_blank(),
plot.title = element_text(hjust = 0.5))
per.ch.plot <- ggplot(per.change) + geom_bar(aes(x = scenario, y = env.change, colour = scenario), stat = "identity", alpha = 0.5) +
labs(x = "", y = "% change") +
theme(axis.text.x = element_text(vjust = 0.5, size = 6),
axis.text.y = element_text(size = 8),
axis.title.y = element_text(size = 10),
legend.position = "none")
per.ch.plot.2 <- ggplot(ch.mods) + geom_violin(aes(x = scenario, y = env.change, colour = scenario), alpha = 0.5) +
geom_boxplot(aes(x = scenario, y = env.change, fill = scenario, colour = scenario), alpha = 0.1) +
labs(x = "", y = "Average % change") +
theme(axis.text.x = element_text(vjust = 0.5, size = 6),
axis.text.y = element_text(size = 8),
axis.title.y = element_text(size = 10),
legend.position = "none")
multiplot(ch.plot, per.ch.plot, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2, 2), ncol = 1))
multiplot(ch.plot, per.ch.plot.2, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2, 2), ncol = 1))
pdf("Plots/Total-change.pdf", width = 9, height = 6)
multiplot(ch.plot, per.ch.plot, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2, 2), ncol = 1))
dev.off()
pdf("Plots/Total.change-2.pdf", width = 9, height = 7)
multiplot(ch.plot, per.ch.plot.2, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2, 2, 2), ncol = 1))
dev.off()
pdf("Plots/Total-change.pdf", width = 9, height = 6)
multiplot(ch.plot, per.ch.plot, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2, 2), ncol = 1))
dev.off()
pdf("Plots/Total.change-2.pdf", width = 9, height = 6)
multiplot(ch.plot, per.ch.plot.2, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2, 2), ncol = 1))
dev.off()
per.ch.plot.2 <- ggplot(ch.mods) + geom_violin(aes(x = scenario, y = env.change, colour = scenario), alpha = 0.5) +
geom_boxplot(aes(x = scenario, y = env.change, fill = scenario, colour = scenario), alpha = 0.1) +
labs(x = "", y = "% change") +
theme(axis.text.x = element_text(vjust = 0.5, size = 6),
axis.text.y = element_text(size = 8),
axis.title.y = element_text(size = 10),
legend.position = "none")
pdf("Plots/Total-change.pdf", width = 9, height = 6)
multiplot(ch.plot, per.ch.plot, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2, 2), ncol = 1))
dev.off()
pdf("Plots/Total.change-2.pdf", width = 9, height = 6)
multiplot(ch.plot, per.ch.plot.2, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2, 2), ncol = 1))
dev.off()
pdf("Plots/Total-change.pdf", width = 9, height = 6)
multiplot(ch.plot, per.ch.plot, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2, 2), ncol = 1))
dev.off()
pdf("Plots/Total-change-2.pdf", width = 9, height = 6)
multiplot(ch.plot, per.ch.plot.2, cols = 1,  layout = matrix(c(1, 1, 1, 1, 1, 2, 2, 2), ncol = 1))
dev.off()
knitr::opts_chunk$set(echo = TRUE)
library(raster)
dem <- raster("LKA-dem-WGS84-1km.tif")
plot(dem)
popn <- raster("pop_2010.asc")
popn <- raster("pop_2010.asc")
plot(popn)
popn <- raster("pop_2010.asc")
popn <- projectRaster(popn, crs = CRS("+init=epsg:4326"))
plot(popn)
pop.preds <- stack(pop.files)
pop.files <- list.files("Population/", "tif", full.names = T, recursive = T)
pop.preds <- stack(pop.files)
pop.preds.sum <- cellStats(pop.preds, sum)
pop.files <- list.files("Population-5km", "tif", full.names = T, recursive = T)
pop.preds <- stack(pop.files)
pop.preds.sum <- cellStats(pop.preds, sum)
pop.preds.sum
pop.files
scen <- expand.grid(SSP = c("SSP1", "SSP2", "SSP5"), year = 2010:2050)
scen
scen <- expand.grid(year = 2010:2050, SSP = c("SSP1", "SSP2", "SSP5"))
scen
nrow(scen)
length(pop.preds.sum)
scen$popn <- pop.preds.sum
library(ggplot2)
ggplot(scen) + geom_line(aes(x = year, y = popn, colour = SSP))
ggplot(scen) + geom_line(aes(x = year, y = popn, colour = SSP)) +
geom_point(aes(x = year, y = popn, colour = SSP), size = 0.2)
ggplot(scen) + geom_step(aes(x = year, y = popn, colour = SSP)) +
geom_point(aes(x = year, y = popn, colour = SSP), size = 0.2)
pop.files <- list.files("Population-5km", "tif", full.names = T, recursive = T)
pop.preds <- stack(pop.files)
pop.preds.sum <- cellStats(pop.preds, sum)
scen <- expand.grid(year = 2010:2050, SSP = c("SSP1", "SSP2", "SSP5"))
scen$popn <- pop.preds.sum
library(ggplot2)
ggplot(scen) + geom_step(aes(x = year, y = popn, colour = SSP)) +
geom_point(aes(x = year, y = popn, colour = SSP), size = 0.2)
knitr::opts_chunk$set(echo = TRUE)
library(raster); library(ggplot2);library(reshape); library(foreach); library(data.table)
incid.data <- readRDS("Data-objects/Incidence models data-Apr2020.rds")
proj.files <- list.files("Incidence-projections", "rds", full.names = T)
projections <- lapply(proj.files, readRDS)
scenarios <- substr(proj.files, 34, nchar(proj.files) - 4)
med.projs <- lapply(projections, function(x){
d <- foreach(i = seq_along(x), .combine = rbind) %do% {colMeans(x[[i]])}
d <- data.frame(d)
d$year <- 2010:2050
return(d)
})
med.projs <- lapply(seq_along(med.projs),
function(x){
med.projs[[x]]$scenario <- scenarios[x]
return(med.projs[[x]])
})
med.projs.df <- rbindlist(med.projs)
med.projs.df$scen <- med.projs.df$scenario
library(ggplot2)
env.time <-  ggplot(med.projs.df) +
geom_ribbon(aes(x = year, ymin = env.025, ymax = env.97, fill = scen), alpha = 0.05) +
geom_point(aes(x = year, y = env.med, colour = scen), size = 0.25) +
geom_line(aes(x = year, y = env.med, colour = scen), size = 0.25, linetype = "dotted") +
geom_hline(yintercept = mean(incid.data$envenomings), colour = "grey50", linetype = "dashed") +
geom_smooth(aes(x = year, y = env.med, colour = scen, fill = scen), alpha = 0.2, size = 0.75, method = "lm") +
labs(x = "Year", y = "Envenoming incidence", colour = "Scenario", fill = "Scenario") +
theme_light() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.7))
env.time
decline.model <- lm(env.med ~ 0 + scen + scen : year, data = med.projs.df)
sum.mod <- summary(decline.model)
sum.mod
knitr::opts_chunk$set(echo = TRUE)
library(raster)
popn <- raster("pop_2010.asc")
plot(popn)
dem <- raster("LKA-dem-WGS84-1km.tif")
dem <- projectRaster(dem, crs = CRS(proj4string(popn)))
plot(dem)
pop.files <- list.files("Population-5km", "tif", full.names = T, recursive = T)
pop.preds <- stack(pop.files)
pop.preds.sum <- cellStats(pop.preds, sum)
scen <- expand.grid(year = 2010:2050, SSP = c("SSP1", "SSP2", "SSP5"))
scen$popn <- pop.preds.sum
library(ggplot2)
ggplot(scen) + geom_step(aes(x = year, y = popn, colour = SSP)) +
geom_point(aes(x = year, y = popn, colour = SSP), size = 0.2)
pop.files
library(raster)
snakes <- stack(list.files("Snakes/", "tif", recursive = T, full.names = T))
snakes <- lapplylist.files("Snakes/", "tif", recursive = T, full.names = T), raster)
snakes <- lapply(list.files("Snakes/", "tif", recursive = T, full.names = T), raster)
sn.files <- list.files("Snakes/", "tif", recursive = T, full.names = T)
head(sn.files)
df.files <- expand.grid(ssp = c("SSP1", "SSP2", "SSP5"), year = 1:2)
df.files
df.files <- expand.grid(year = 1:2, ssp = c("SSP1", "SSP2", "SSP5"), spp = c("B. caeruleus", "B. ceylonicus"))
df.files
df.files <- expand.grid(species = c("B. caeruleus", "B. ceylonicus", "D. russelli", "E. carinatus", "H. spp", "N. naja", "T. trigonocephalus"), year = 2010:2050, ssp = c("SSP1", "SSP2", "SSP5"))
df.files
df.files[1:10]
sn.files[1:10]
id <- which(df.files$year %in% c(2010, 2024, 2037, 2050))
id
snakes <- lapply(sn.files[id], raster)
snakes.dfl <- lapply(snakes, rasterToPoints)
length(id)
df.files.id <- df.files[id, ]
length(sn.files)
4*41
7*41
sn.files[288:298]
df.files <- expand.grid(species = c("B. caeruleus", "B. ceylonicus", "D. russelli", "E. carinatus", "H. spp", "N. naja", "T. trigonocephalus"), year = 2010:2050, GCM = c(""), ssp = c("SSP1"))
df.files.1 <- expand.grid(species = c("B. caeruleus", "B. ceylonicus", "D. russelli", "E. carinatus", "H. spp", "N. naja", "T. trigonocephalus"), year = 2010:2050, GCM = c(""), ssp = c("SSP1"))
df.files.25 <- expand.grid(species = c("B. caeruleus", "B. ceylonicus", "D. russelli", "E. carinatus", "H. spp", "N. naja", "T. trigonocephalus"), year = 2010:2050, GCM = c("CNRM-CM5", "GFDL-CM3", "MPI-ESM-LR"), ssp = c("SSP2", "SSP5"))
df.files <- data.frame(df.files.1, df.files.25)
id <- which(df.files$year %in% c(2010, 2024, 2037, 2050))
snakes <- lapply(sn.files[id], raster)
length(snakes)
168/7
168/4
par(mfrow = c(4, 42))
for(i in seq_along(id)){
plot(snakes[[i]], main = paste0(df.files$species[i],": ", df.files$year[i], " (", df.files$ssp[i], ", ", df.files$GCM[i], ")"))
}
x = 1
s
x
knitr::opts_chunk$set(echo = TRUE)
library(raster)
sn.files <- list.files("Snakes", "tif", recursive = T, full.names = T)
df.files.1 <- expand.grid(species = c("B. caeruleus", "B. ceylonicus", "D. russelli", "E. carinatus", "H. spp", "N. naja", "T. trigonocephalus"), year = 2010:2050, GCM = c(""), ssp = c("SSP1"))
df.files.25 <- expand.grid(species = c("B. caeruleus", "B. ceylonicus", "D. russelli", "E. carinatus", "H. spp", "N. naja", "T. trigonocephalus"), year = 2010:2050, GCM = c("CNRM-CM5", "GFDL-CM3", "MPI-ESM-LR"), ssp = c("SSP2", "SSP5"))
df.files <- data.frame(df.files.1, df.files.25)
id.ssp1 <- which(df.files$ssp == "SSP1" & df.files$year %in% c(2010, 2024, 2037, 2050))
id.ssp2 <- which(df.files$ssp == "SSP2" & df.files$year %in% c(2010, 2024, 2037, 2050))
id.ssp5 <- which(df.files$ssp == "SSP5" & df.files$year %in% c(2010, 2024, 2037, 2050))
id.ssp1
id.ssp2 <- which(df.files$ssp == "SSP2" & df.files$year %in% c(2010, 2024, 2037, 2050))
id.ssp5 <- which(df.files$ssp == "SSP5" & df.files$year %in% c(2010, 2024, 2037, 2050))
snakes.ssp1 <- lapply(sn.files[id.ssp1], raster)
snakes.ssp2 <- lapply(sn.files[id.ssp2], raster)
snakes.ssp5 <- lapply(sn.files[id.ssp5], raster)
length(snakes.ssp1)
length(snakes.ssp2)
df.files.25
df.files.25 <- expand.grid(species = c("B. caeruleus", "B. ceylonicus", "D. russelli", "E. carinatus", "H. spp", "N. naja", "T. trigonocephalus"), year = 2010:2050, GCM = c("CNRM-CM5", "GFDL-CM3", "MPI-ESM-LR"), ssp = c("SSP2", "SSP5"))
dim(df.files.25)
df.files <- data.frame(df.files.1, df.files.25)
id.ssp2 <- which(df.files$ssp == "SSP2" & df.files$year %in% c(2010, 2024, 2037, 2050))
id.ssp2
head(df.files)
df.files <- rbind(df.files.1, df.files.25)
head(df.files)
id.ssp1 <- which(df.files$ssp == "SSP1" & df.files$year %in% c(2010, 2024, 2037, 2050))
id.ssp2 <- which(df.files$ssp == "SSP2" & df.files$year %in% c(2010, 2024, 2037, 2050))
id.ssp5 <- which(df.files$ssp == "SSP5" & df.files$year %in% c(2010, 2024, 2037, 2050))
snakes.ssp1 <- lapply(sn.files[id.ssp1], raster)
snakes.ssp2 <- lapply(sn.files[id.ssp2], raster)
lean
length(snakes.ssp2)
length(snakes.ssp1)
length(snakes.ssp5)
id.ssp5
length(id.ssp5)
snakes.ssp5 <- lapply(sn.files[id.ssp5], raster)
length(snakes.ssp5)
24/28
78/7
28/7
par(mfrow = c(4, 7))
for(i in seq_along(id.ssp1)){
plot(snakes.ssp1[[i]], main = paste0(df.files$species[id.ssp1[i]],": ",
df.files$year[id.ssp1[i]], " (",
df.files$ssp[id.ssp1[i]], ", ",
df.files$GCM[id.ssp1[i]], ")"))
}
par(mfrow = c(4, 7))
for(i in seq_along(id.ssp1)){
plot(snakes.ssp1[[i]], main = paste0(df.files$species[id.ssp1[i]],": ",
df.files$year[id.ssp1[i]], " (",
df.files$ssp[id.ssp1[i]], ", ",
df.files$GCM[id.ssp1[i]], ")"))
}
par(mfrow = c(4, 7))
for(i in seq_along(id.ssp1)){
plot(snakes.ssp1[[i]], main = paste0(df.files$species[id.ssp1[i]],": ",
df.files$year[id.ssp1[i]], " (",
df.files$ssp[id.ssp1[i]], ", ",
df.files$GCM[id.ssp1[i]], ")"),
cex.main = 0.5)
}
par(mfrow = c(7, 4))
for(i in seq_along(id.ssp1)){
plot(snakes.ssp1[[i]], main = paste0(df.files$species[id.ssp1[i]],": ",
df.files$year[id.ssp1[i]], " (",
df.files$ssp[id.ssp1[i]], ", ",
df.files$GCM[id.ssp1[i]], ")"),
cex.main = 0.5)
}
par(mfrow = c(4, 7))
for(i in seq_along(id.ssp1)){
plot(snakes.ssp1[[i]], main = paste0(df.files$species[id.ssp1[i]],": ",
df.files$year[id.ssp1[i]], " (",
df.files$ssp[id.ssp1[i]], ", ",
df.files$GCM[id.ssp1[i]], ")"),
cex.main = 0.5)
}
84/7
curve(x*(1-x), 0, 1)
curve(x*(1-x), 0, 1, xlab = "N", ylab = "dN/dt")
curve(x*(1-x), 0, 1, xlab = "N", ylab = "dN/dt", col = "red")
