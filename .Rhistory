theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_text(size = 6),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_blank())
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = r2)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = expression(italic(R)^2)) +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_text(size = 6),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12))
pdf("Plots/Spatial-r2.pdf", width = 3, height = 15)
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = r2)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = expression(italic(R)^2)) +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_text(size = 6),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12))
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = r2)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = expression(italic(R)^2)) +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_text(size = 6),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12))
dev.off()
pdf("Plots/Spatial-rates.of change.pdf", width = 3, height = 15)
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = rate)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = "Annual \n change") +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_text(size = 6),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_blank())
dev.off()
pdf("Plots/Spatial-r2.pdf", width = 3, height = 15)
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = r2)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = expression(italic(R)^2)) +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_text(size = 6),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12))
dev.off()
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = r2)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = expression(italic(R)^2)) +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_text(size = 6),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12))
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = P)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = expression(italic(P))) +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_text(size = 6),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12))
pdf("Plots/Spatial-r2.pdf", width = 3, height = 15)
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = r2)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = expression(italic(R)^2)) +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_text(size = 6),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12))
dev.off()
library(dplyr)
library(data.table)
incid.data <- readRDS("../SNAKEBITE MODELLING/Data objects/Incid-models-data-Aug-2020/Incidence models data-Apr2020.rds")
SSP <- c("SSP1", rep("SSP2", 3),
rep("SSP5", 3))
projs.df <- projections
for(i in seq_along(projs.df)){
for(j in seq_along(projs.df[[i]])){
projs.df[[i]][[j]]$year <- c(2010:2050)[j]
projs.df[[i]][[j]]$scenario <- rates.df$proj[i]
projs.df[[i]][[j]]$SSP <- SSP[i]
projs.df[[i]][[j]] <- cbind(incid.data[, c("x", "y")], projs.df[[i]][[j]])
}
projs.df[[i]] <- rbindlist(projs.df[[i]])
}
projs.df <- rbindlist(projs.df)
projs.df.sum <- projs.df %>% group_by(x, SSP, year) %>% summarise(
sb.med = mean(sb.med),
sb.025 = mean(sb.025),
sb.97 = mean(sb.97),
env.med = mean(env.med),
env.025 = mean(env.025),
env.97 = mean(env.97),
y = y)
spp <- c("Bungarus caeruleus", "Bungarus ceylonicus",
"Daboia russelii", "Echis carinatus",
"Hypnale spp.", "Naja naja",
"Trimeresurus trigonocephalus")
proj.sn <- lapply(seq_along(projections), function(x){
df <- rbindlist(lapply(ceiling(seq(1, 41, len = 4)), function(x1){
return(data.frame(incid.data[, c("x", "y")], Species = spp[projections[[x]][[x1]]$snakes],
year = c(2010:2050)[x1]))
}))
df$scenario <- scenarios[x]
return(df)
})
proj.sn.df <- rbindlist(proj.sn)
ggplot(proj.sn.df) + geom_tile(aes(x = x, y = y, fill = as.factor(Species))) +
facet_grid(scenario ~ year) + coord_fixed(ratio = 1) +
scale_fill_manual(values = rev(plasma(5))[2:5]) +
labs(fill = "") +
theme_light() +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_text(size = 6),
legend.text = element_text(face = "italic", size = 12),
strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12))
pdf("Plots/Snake-species-time-scenario.pdf", width = 6.5, height = 15)
ggplot(proj.sn.df) + geom_tile(aes(x = x, y = y, fill = Species)) +
facet_grid(scenario ~ year) + coord_fixed(ratio = 1) +
scale_fill_manual(values = rev(inferno(5))[2:5]) +
labs(fill = "") +
theme_light() +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_text(size = 6),
strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12),
legend.text = element_text(face = "italic", size = 12))
dev.off()
ggplot(proj.sn.df) + geom_tile(aes(x = x, y = y, fill = Species)) +
facet_grid(scenario ~ year) + coord_fixed(ratio = 1) +
scale_fill_manual(values = rev(inferno(5))[2:5]) +
labs(fill = "") +
theme_light() +
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_text(size = 6),
strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12),
legend.text = element_text(face = "italic", size = 12))
rates.df$Estimate/mean(incid.data$envenomings)
rates.df$Estimate/mean(incid.data$envenomings) * 100
percent.plot <- ggplot(rates.df) + geom_bar(aes(x = proj, y = Estimate, colour = proj, stat = "identity"))+
scale_shape_manual(values = c(4, 20)) +
labs(colour = "Scenario", y = "Percent change per year",
x = "") +
theme(axis.text.x = element_text(size = 0),
legend.position = "none")
percent.plot
percent.plot <- ggplot(rates.df) + geom_bar(aes(x = proj, y = Estimate, colour = proj, stat = "identity"))+
scale_shape_manual(values = c(4, 20))
percent.plot <- ggplot(rates.df) + geom_bar(aes(x = proj, y = Estimate, colour = proj), stat = "identity")+
scale_shape_manual(values = c(4, 20)) +
labs(colour = "Scenario", y = "Percent change per year",
x = "") +
theme(axis.text.x = element_text(size = 0),
legend.position = "none")
percent.plot
percent.plot <- ggplot(rates.df) + geom_bar(aes(x = proj, y = Estimate, colour = proj, fill = proj),
stat = "identity", alpha = 0.5)+
scale_shape_manual(values = c(4, 20)) +
labs(colour = "Scenario", y = "Percent change per year",
x = "") +
theme(axis.text.x = element_text(size = 0),
legend.position = "none")
percent.plot
percent.plot <- ggplot(rates.df) + geom_bar(aes(x = proj, y = Estimate*(-1), colour = proj, fill = proj),
stat = "identity", alpha = 0.5)+
scale_shape_manual(values = c(4, 20)) +
labs(colour = "Scenario", y = "Percent change per year",
x = "") +
theme(axis.text.x = element_text(size = 0),
legend.position = "none")
percent.plot
rates.plot <- ggplot(rates.df) + geom_boxplot(aes(x = 1, y = Estimate)) +
geom_point(aes(x = proj, y = Estimate, colour = proj, shape = signif ), size = 3, position = position_dodge(0.3))+
scale_shape_manual(values = c(4, 20)) +
geom_linerange(aes(x = proj, ymin = Estimate - Std..Error, ymax = Estimate + Std..Error, colour = proj)) +
labs(colour = "Scenario", y = "Absolute incidence change per year",
x = "") +
theme(axis.text.x = element_text(size = 0),
legend.position = "none")
rates.plot
rates.plot <- ggplot(rates.df) + geom_boxplot(aes(x = 1, y = Estimate)) +
geom_point(aes(x = proj, y = Estimate, colour = proj, shape = signif ), size = 3)+
scale_shape_manual(values = c(4, 20)) +
geom_linerange(aes(x = proj, ymin = Estimate - Std..Error, ymax = Estimate + Std..Error, colour = proj)) +
labs(colour = "Scenario", y = "Absolute incidence change per year",
x = "") +
theme(axis.text.x = element_text(size = 0),
legend.position = "none")
rates.plot
rates.plot <- ggplot(rates.df) + geom_boxplot(aes(x = 1, y = Estimate)) +
geom_point(aes(x = 1, y = Estimate, colour = proj, shape = signif ), size = 3, position = position_dodge(0.3))+
scale_shape_manual(values = c(4, 20)) +
geom_linerange(aes(x = 1, ymin = Estimate - Std..Error, ymax = Estimate + Std..Error, colour = proj), position = position_dodge(0.3)) +
labs(colour = "Scenario", y = "Absolute incidence change per year",
x = "") +
theme(axis.text.x = element_text(size = 0),
legend.position = "none")
rates.plot
percent.plot <- ggplot(rates.df) + geom_bar(aes(x = proj, y = Estimate*(-1), colour = proj, fill = proj),
stat = "identity", alpha = 0.5)+
scale_shape_manual(values = c(4, 20)) +
labs(colour = "Scenario", y = "Percent change per year",
x = "") +
theme(axis.text.x = element_text(size = 0),
legend.position = "none")
percent.plot
percent.plot <- ggplot(rates.df) + geom_bar(aes(x = proj, y = Percent.decline*(-1), colour = proj, fill = proj),
stat = "identity", alpha = 0.5)+
scale_shape_manual(values = c(4, 20)) +
labs(colour = "Scenario", y = "Percent change per year",
x = "") +
theme(axis.text.x = element_text(size = 0),
legend.position = "none")
percent.plot
rates.df$Percent.decline <- rates.df$Estimate/mean(incid.data$envenomings) * 100
percent.plot <- ggplot(rates.df) + geom_bar(aes(x = proj, y = Percent.decline*(-1), colour = proj, fill = proj),
stat = "identity", alpha = 0.5)+
scale_shape_manual(values = c(4, 20)) +
labs(colour = "Scenario", y = "Percent change per year",
x = "") +
theme(axis.text.x = element_text(size = 0),
legend.position = "none")
percent.plot
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = rate)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = "Annual \n change") +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_text(size = 6),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_blank())
library(viridis)
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = rate)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = "Annual \n rate") +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_text(size = 6),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_blank())
pdf("Plots/Spatial-rates.of change.pdf", width = 3, height = 15)
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = rate)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = "Annual \n change") +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_text(size = 6),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_blank())
dev.off()
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = r2)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = expression(italic(R)^2)) +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_blank(),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12))
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = r2)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = expression(italic(R)^2)) +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_text(size = 6),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12))
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = P)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = expression(italic(P))) +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_blank(),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12))
pdf("Plots/Spatial-r2.pdf", width = 3, height = 15)
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = r2)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = expression(italic(R)^2)) +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_blank(),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12))
dev.off()
pdf("Plots/Spatial-r2.pdf", width = 3, height = 15)
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = r2)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = expression(italic(R)^2)) +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12))
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = r2)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = expression(italic(R)^2)) +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_text(size = 6),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12))
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = P)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = expression(italic(P))) +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_blank(),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12))
pdf("Plots/Spatial-r2.pdf", width = 3, height = 15)
ggplot(ch.mods) + geom_raster(aes(x = x, y = y, fill = r2)) +
facet_grid(scenario ~ 1) + coord_fixed(ratio = 1) +
scale_fill_gradientn(colours = (inferno(100))) +
labs(fill = expression(italic(R)^2)) +
theme_light()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45, vjust = 0.5, size = 6),
axis.text.y = element_blank(),
axis.title.y = element_blank(),
legend.text = element_text(angle = 45, vjust = 0.5),
legend.title = element_text(size = 14),
strip.text.x = element_text(size = 12),
strip.text.y = element_text(size = 12))
dev.off()
View(proj.sn)
knitr::opts_chunk$set(echo = TRUE)
library(raster); library(ggplot2);library(reshape); library(foreach); library(data.table)
library(raster); library(ggplot2);library(reshape); library(foreach); library(data.table)
incid.data <- readRDS("../SNAKEBITE MODELLING/Data objects/Incid-models-data-Aug-2020/Incidence models data-Apr2020.rds")
proj.files <- list.files("Incidence-projections", "rds", full.names = T)
projections <- lapply(proj.files, readRDS)
library(foreach); library(data.table)
scenarios <- substr(proj.files, 34, nchar(proj.files) - 4)
med.projs <- lapply(projections, function(x){
d <- foreach(i = seq_along(x), .combine = rbind) %do% {colMeans(x[[i]])}
d <- data.frame(d)
d$year <- 2010:2050
return(d)
})
med.projs <- lapply(seq_along(med.projs),
function(x){
med.projs[[x]]$scenario <- scenarios[x]
return(med.projs[[x]])
})
med.projs.df <- rbindlist(med.projs)
med.projs.df$scen <- med.projs.df$scenario
library(ggplot2)
env.time <-  ggplot(med.projs.df) +
geom_ribbon(aes(x = year, ymin = env.025, ymax = env.97, fill = scen), alpha = 0.05) +
geom_point(aes(x = year, y = env.med, colour = scen), size = 0.25) +
geom_line(aes(x = year, y = env.med, colour = scen), size = 0.25, linetype = "dotted") +
geom_hline(yintercept = mean(incid.data$envenomings), colour = "grey50", linetype = "dashed") +
geom_smooth(aes(x = year, y = env.med, colour = scen, fill = scen), alpha = 0.2, size = 0.75, method = "lm") +
labs(x = "Year", y = "Envenoming incidence", colour = "Scenario", fill = "Scenario") +
theme_light() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.7))
env.time
decline.model <- lm(env.med ~ 0 + scen + scen : year, data = med.projs.df)
sum.mod <- summary(decline.model)
sum.mod
rates <- data.frame(sum.mod$coefficients)
rates.df <- rates[8:14,]
rates.df$proj <- c("SSP1",
"SSP2 CNRM-CM5", "SSP2 GFDL-CM3", "SSP2 MPI-ESM-LR",
"SSP5 CNRM-CM5", "SSP5 GFDL-CM3", "SSP5 MPI-ESM-LR")
rates.df$signif <- as.factor(ifelse(rates.df$Pr...t.. > 0.05, 0, 1))
rates.df$SSP <- as.factor(substr(rates.df$proj, 1, 4))
rates
length(rates.df$Estimate)
Percent.decline <- (rates.df$Estimate + rates$Estimate[1:7])/mean(incid.data$envenomings) * 100
Percent.decline
rates
Percent.decline <- (rates.df$Estimate)/mean(incid.data$envenomings) * 100
Percent.decline
rates.df$Percent.decline <- rates.df$Estimate/mean(incid.data$envenomings) * 100
rates.plot
rates.plot <- ggplot(rates.df) + geom_boxplot(aes(x = 1, y = Estimate)) +
geom_point(aes(x = 1, y = Estimate, colour = proj, shape = signif ), size = 3, position = position_dodge(0.3))+
scale_shape_manual(values = c(4, 20)) +
geom_linerange(aes(x = 1, ymin = Estimate - Std..Error, ymax = Estimate + Std..Error, colour = proj), position = position_dodge(0.3)) +
labs(colour = "Scenario", y = "Absolute incidence change per year",
x = "") +
theme(axis.text.x = element_text(size = 0),
legend.position = "none")
rates.plot
percent.plot <- ggplot(rates.df) + geom_bar(aes(x = proj, y = Percent.decline*(-1), colour = proj, fill = proj),
stat = "identity", alpha = 0.5)+
scale_shape_manual(values = c(4, 20)) +
labs(colour = "Scenario", y = "Percent change per year",
x = "") +
theme(axis.text.x = element_text(size = 0),
legend.position = "none")
percent.plot
rates <- data.frame(sum.mod$coefficients)
rates.df <- rates[8:14,]
rates.df$proj <- c("SSP1",
"SSP2 CNRM-CM5", "SSP2 GFDL-CM3", "SSP2 MPI-ESM-LR",
"SSP5 CNRM-CM5", "SSP5 GFDL-CM3", "SSP5 MPI-ESM-LR")
rates.df$signif <- as.factor(ifelse(rates.df$Pr...t.. > 0.05, 0, 1))
rates.df$SSP <- as.factor(substr(rates.df$proj, 1, 4))
rates.df$Percent.decline <- rates.df$Estimate/mean(incid.data$envenomings) * 100
rates.plot <- ggplot(rates.df) + geom_boxplot(aes(x = 1, y = Estimate)) +
geom_point(aes(x = 1, y = Estimate, colour = proj, shape = signif ), size = 3, position = position_dodge(0.3))+
scale_shape_manual(values = c(4, 20)) +
geom_linerange(aes(x = 1, ymin = Estimate - Std..Error, ymax = Estimate + Std..Error, colour = proj), position = position_dodge(0.3)) +
labs(colour = "Scenario", y = "Absolute incidence change per year",
x = "") +
theme(axis.text.x = element_text(size = 0),
legend.position = "none")
rates.plot
percent.plot <- ggplot(rates.df) + geom_bar(aes(x = proj, y = Percent.decline*(-1), colour = proj, fill = proj),
stat = "identity", alpha = 0.5)+
scale_shape_manual(values = c(4, 20)) +
labs(colour = "Scenario", y = "Percent change per year",
x = "") +
theme(axis.text.x = element_text(size = 0),
legend.position = "none")
percent.plot
rates.df$Percent.decline
rates.df$Percent.decline * 40/100
rates.df$Percent.decline * 40
rates.df$Percent.decline
rates.df$Percent.decline * 40 * (-0.01)
rates.df$Percent.decline * 40 * (-0.01) * 100
rates.df$Percent.decline * 40 * (-1)
